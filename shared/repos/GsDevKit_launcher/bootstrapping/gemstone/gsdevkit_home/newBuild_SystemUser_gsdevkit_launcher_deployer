set -e
. defStone.env

rm -rf *.log *.out

if [ -e "snapshots/extent0.tode.dbf" ] ; then
	# tODE has already been installed, reuse the extent
	newExtent -t -s snapshots/extent0.tode.dbf $GEMSTONE_NAME
else
	# have to do first-time tODE install first
	newExtent $GEMSTONE_NAME
	todeLoad $GEMSTONE_NAME
fi

$ROWAN_PROJECTS_HOME/GsDevKit_launcher/bootstrapping/gemstone/bin/bootstrap_install_tode.tpz $GEMSTONE_NAME -lq

#	this script needs to be rewritten for gsdevkit_launcher
rm -f snapshots/extent0.gsdevkit_launcher.dbf
stopStone $GEMSTONE_NAME	# in 3.5.1 do a snapshot instead
cp extents/extent0.dbf snapshots/extent0.gsdevkit_launcher.dbf

# cp the solo extent to snapshots directory
chmod oug-w snapshots/extent0.gsdevkit_launcher.dbf
cp -f snapshots/extent0.gsdevkit_launcher.dbf $GS_HOME/shared/gemstone/snapshots/
pushd $GS_HOME/shared/gemstone/snapshots/
	rm -rf extent0.gsdevkit_launcher.dbf.zip
	zip extent0.gsdevkit_launcher.dbf.zip extent0.gsdevkit_launcher.dbf
popd
startStone $GEMSTONE_NAME	# in 3.5.1 snapshot up above

$ROWAN_PROJECTS_HOME/GsDevKit_launcher/bootstrapping/gemstone/bin/bootstrap_install_scripts.tpz $GEMSTONE_NAME -lq

todeIt $GEMSTONE_NAME mount @/sys/stone/dirs/GsDevKit_launcher/shared/repos/GsDevKit_launcher/tode /home gsdevkit_launcher

